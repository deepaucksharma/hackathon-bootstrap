name: "Phase 1 / Test 1.2: Negative Control - Wrong Collector"
description: "Sends golden payload but with collector.name: 'nri-kafka'. UI visibility should FAIL."
baseTemplate: "reference/working-account-samples/broker-events.json"

modifications:
  - action: "set"
    path: "entityName"
    value: "p1-negative-broker-${timestamp}"
  - action: "set"
    path: "_experimentId"
    value: "${experimentId}"
  - action: "set"
    path: "timestamp"
    value: "${timestamp}"
  - action: "set"
    path: "collector.name"
    value: "nri-kafka"

verification:
  timeout: 300
  initialDelay: 30
  checks:
    - type: "entityExists"
      details: 
        entityName: "p1-negative-broker-${timestamp}"
        entityType: "AWS_KAFKA_BROKER"
    
    - type: "uiQuery"
      details:
        query: "FROM AwsMskBrokerSample SELECT count(*) WHERE entityName = 'p1-negative-broker-${timestamp}' SINCE 30 minutes ago"
    
    - type: "metricPopulated"
      details:
        entityName: "p1-negative-broker-${timestamp}"
        metricName: "provider.bytesInPerSec.Average"
    
    - type: "messageQueueSample"
      details:
        entityName: "p1-negative-broker-${timestamp}"
    
    - type: "entityIsVisibleInUi"
      details:
        entityName: "p1-negative-broker-${timestamp}"
        uiContext: "queuesAndStreams"

expectedOutcome: "entityIsVisibleInUi_FAIL"
keyInsight: "cloud-integrations collector is NON-NEGOTIABLE for UI visibility"